# Test automation

---

### What to automate

First thing first, a complete publish flow with photo gallery needs to be automated and integrated with CI. All key user flows are planned to be automated.

### How to automate

For Android UI test automation, the first choice would be [**Espresso**](https://developer.android.com/training/testing/ui-testing/espresso-testing.html\), if the tests are going to be maintained by developers and Espresso [**IdlingResource**]\(https://developer.android.com/reference/android/support/test/espresso/IdlingResource.html\), if [**IdlingResource interface**]\(https://developer.android.com/reference/android/support/test/espresso/IdlingResource.html\) if [**IdlingResource interface**]\(https://developer.android.com/reference/android/support/test/espresso/IdlingResource.html\), if [**IdlingResource Interface**]\(https://developer.android.com/reference/android/support/test/espresso/IdlingResource.html). If **IdlingResource interface** has been broadly implemented across the app, so Espresso tests could easily register to it for easy synchronized waiting. However this is not the case for the current WP Android app, plus the entire POST editor is a webview, which requires further adoption of [Espresso-web](https://google.github.io/android-testing-support-library/docs/espresso/web/).

### Automation status

Currently, an [**Appium**](http://appium.io/) solution has been created as [**here**](https://github.com/chenchaoyi/wp-android-tests). Since WP Android app has well-organized **content-desc** attribute to most of the key elements, the locators are surprisingly easy to find. The current solution has implemented an example of an entire gallery creation flow, a screencast of its live action could be find [**here**](https://www.dropbox.com/s/fvsc941tufa3fq6/wp_android_appium.mp4?dl=0) too.

The structure of the Appium tests are as follows:   

> ```
> ├── config
> │   ├── default.json
> │   └── testData.json
> ├── lib
> │   ├── index.js
> │   └── pages
> │       ├── editor.js
> │       ├── general.js
> │       ├── mysite.js
> │       └── signin.js
> └── test
>     ├── mocha.opts
>     ├── test.js
>     └── wp
>         └── publish.js
> ```

It adopts page object convention, all pages are defined under `lib/pages`, and all test suites will be placed under `test/wp`.



